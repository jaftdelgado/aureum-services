name: Sync Fork (Debug)

on:
  push:
    branches:
      - master

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout upstream repo
      uses: actions/checkout@v3
      with:
        fetch-depth: 0

    - name: Show remotes BEFORE
      run: git remote -v

    - name: Remove old fork remote if exists
      run: git remote remove fork || true

    - name: Add fork remote WITH TOKEN
      run: |
        echo "Adding remote:"
        echo "https://CesarEduardoCeronM:${{ secrets.FORK_SYNC_TOKEN }}@github.com/CesarEduardoCeronM/aureum-services.git"
        git remote add fork https://CesarEduardoCeronM:${{ secrets.FORK_SYNC_TOKEN }}@github.com/CesarEduardoCeronM/aureum-services.git

    - name: Show remotes AFTER
      run: git remote -v

    - name: Git config
      run: |
        git config --global user.email "actions@github.com"
        git config --global user.name "GitHub Actions"

    - name: Push to fork
      run: |
        echo "Pushing..."
        git push fork master --force


    - name: Push to fork
      run: git push fork master --force 

